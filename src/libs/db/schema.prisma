generator kysely {
  provider     = "prisma-kysely"
  output       = "./"
  enumFileName = "enums.ts"
  fileName     = "types.ts"
}

datasource db {
  provider = "sqlserver"
  url      = env("SQLSERVER_URL")
}

model upload_file {
  id         String    @id(map: "PK_upload_file") @db.UniqueIdentifier
  file_name  String?   @db.NVarChar(100)
  url        String?   @db.NVarChar(500)
  created_at DateTime? @db.DateTime
  photos     photos[]
}

model code_hair_design {
  id              Int             @id(map: "PK_code_hair_design") @default(autoincrement())
  style_id        Int
  name            String          @db.NVarChar(50)
  published_at    DateTime?       @db.DateTime
  order_seq       Int?
  code_hair_style code_hair_style @relation(fields: [style_id], references: [id], onUpdate: NoAction, map: "FK_code_hair_design_code_hair_style")
  prompt          prompt?
}

model code_hair_style {
  id               Int                @id(map: "PK_code_hair_style") @default(autoincrement())
  name             String             @db.NVarChar(50)
  published_at     DateTime?          @db.DateTime
  order_seq        Int?
  code_hair_design code_hair_design[]
}

model kakao_log {
  key               Int       @id(map: "PK_kakao_log") @default(autoincrement())
  user_id           String?   @db.UniqueIdentifier
  phone_number      String?   @db.VarChar(20)
  template_code     String?   @db.VarChar(50)
  created_at        DateTime? @db.DateTime
  json              String?   @db.NVarChar(2000)
  result_code       String?   @db.VarChar(50)
  exception_message String?   @db.NVarChar(2000)
}

model photos {
  id                        Int         @id(map: "PK_photos") @default(autoincrement())
  user_id                   String      @db.UniqueIdentifier
  upload_file_id            String      @db.UniqueIdentifier
  payment_id                Int?
  code                      String?     @db.NVarChar(50)
  created_at                DateTime?   @db.DateTime
  selected_design_id        Int?
  thumbnail_before_after_id String?     @db.UniqueIdentifier
  thumbnail_worldcup_id     String?     @db.UniqueIdentifier
  merged_image_id           String?     @db.UniqueIdentifier
  status                    String?     @db.NVarChar(50)
  retry_count               Int?
  upload_file               upload_file @relation(fields: [upload_file_id], references: [id], onUpdate: NoAction, map: "FK_photos_upload_file")
}

model prompt {
  design_id        Int              @id(map: "PK_prompt")
  ment             String?          @db.NVarChar(Max)
  upload_file_id   String?          @db.UniqueIdentifier
  code_hair_design code_hair_design @relation(fields: [design_id], references: [id], onUpdate: NoAction, map: "FK_prompt_code_hair_design")
}

model users {
  id                String   @id(map: "PK_users_1") @db.UniqueIdentifier
  phone             String   @db.NVarChar(50)
  created_at        DateTime @db.DateTime
  name              String?  @db.NVarChar(50)
  use_code_id       String?  @db.NVarChar(50)
  use_code_photo_id Int?
  sample_type       Int?
}

model user_certification {
  id           Int      @id(map: "PK_user_certification") @default(autoincrement())
  phone_number String   @db.NVarChar(50)
  code         String   @db.NVarChar(50)
  required_at  DateTime @db.DateTime
  expire_time  DateTime @db.DateTime
}

model payments {
  id         Int       @id(map: "PK_payments") @default(autoincrement())
  user_id    String?   @db.UniqueIdentifier
  status     String?   @db.NVarChar(50)
  created_at DateTime? @db.DateTime
  tid        String?   @db.NVarChar(Max)
  oid        String?   @db.NVarChar(Max)
  price      Int?
}

model photo_code_log {
  id           Int       @id(map: "PK_photo_code_log") @default(autoincrement())
  photo_id     Int?
  code         String?   @db.NVarChar(50)
  used_user_id String?   @db.UniqueIdentifier
  created_at   DateTime? @db.DateTime
}

model photo_results {
  id                Int       @id(map: "PK_photo_results") @default(autoincrement())
  original_photo_id Int?
  hair_design_id    Int?
  result_image_id   String?   @db.UniqueIdentifier
  created_at        DateTime? @db.DateTime
  status            String?   @db.NVarChar(10)
  try_count         Int?
  fail_code         String?   @db.NVarChar(50)
}

model photo_share_code {
  id         Int       @id(map: "PK_photo_share_code") @default(autoincrement())
  photo_id   Int?
  code       String?   @db.NVarChar(50)
  created_at DateTime? @db.DateTime
  expired_at DateTime? @db.DateTime
  code_type  String?   @db.NVarChar(50)
}

model worldcup_votes {
  id         Int       @id(map: "PK_worldcup_votes") @default(autoincrement())
  photo_id   Int?
  result_id  Int?
  name       String?   @db.NVarChar(50)
  user_id    String?   @db.UniqueIdentifier
  created_at DateTime? @db.DateTime
}

model token {
  id         Int       @id(map: "PK_token") @default(autoincrement())
  user_id    String?   @db.UniqueIdentifier
  token      String?   @db.NVarChar(50)
  created_at DateTime? @db.DateTime
  expired_at DateTime? @db.DateTime
}

model log_gemini_error {
  id         Int       @id(map: "PK_log_gemini_error") @default(autoincrement())
  created_at DateTime? @db.DateTime
  photo_id   Int?
  design_id  Int?
  error      String?   @db.NVarChar(Max)
}

model scheduler_log {
  id         Int       @id(map: "PK_scheduler_log") @default(autoincrement())
  type       String?   @db.NVarChar(100)
  start_at   DateTime? @db.DateTime
  success_at DateTime? @db.DateTime
  fail_at    DateTime? @db.DateTime
  is_publish Boolean?
}

model worldcup_log {
  id            Int       @id(map: "PK_worldcup_log") @default(autoincrement())
  photo_id      Int?
  user_id       String?   @db.UniqueIdentifier
  accessed_at   DateTime? @db.DateTime
  first_vote_at DateTime? @db.DateTime
  last_vote_at  DateTime? @db.DateTime
}
